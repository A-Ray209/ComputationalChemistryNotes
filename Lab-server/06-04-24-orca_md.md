### 1. orca 进行量子动力学模拟

#### 1.1 生成输入文件

```
! r2SCAN-3c  MD                                  # 计算命令
%md
  Timestep 0.5_fs                                # 时间步长 (fs)
  run 200                                        # 总步数
  Initvel 300.0_K                                # 温度 (K)
  thermostat berendsen 300_K Timecon 10.0_fs     # Nose-Hoover 温控器
  Dump position Stride 1 Filename "traj.xyz"
end
%pal nprocs 44                                   # 44 核
     end           
%MaxCore 2327                                    # 为每个核心分配的最大内存为 2560 MB
``` 
### 2. 计算更高阶的 krisc （Marcus方程）

需要计算 Huang-Rhy 因子（参考 05-29-24-Huang-Rhys.md 的  FCclasses）:

1. 计算 s1 的 td opt freq 
2. 计算 t1 的 td(Triplet) opt freq
3. 生成 s1 的偶极子文件： gen_fcc_dipfile -i *_tdopt_freq.fchk
4. 提交  FCclasses 计算

### 3. 计算苯的 Hessian 矩阵

Hessian 矩阵可用于计算激发态性质，根据 orca 手册 8.15 内容

以苯环为例，需要计算 s0，s1 的 OPT FREQ 以及 opt-s0 的

> 使用钟老师脚本进行 orca 计算，会将文件 cp 到缓存目录，计算完成后再 cp 回来，所以在进行其他计算时需要用到（例如 .hessian）需要修改提交任务的脚本

计算步骤 1：计算 s0
```
! PBE0 def2-SVP OPT FREQ
%pal nprocs 40
     end
%MaxCore 2560
* xyz 0 1
C                 -1.21339970    0.56543703   -0.02328761
...
H                 -3.01038570    1.77359603   -0.02414961
*
```
计算步骤 2：计算 s1 
```
! PBE0 def2-SVP OPT FREQ
%tddft
nroots 5
IROOT 1
end
%pal nprocs 40
     end
%MaxCore 2560
* xyz 0 1
C                 -1.21339970    0.56543703   -0.02328761
...
H                 -3.01038570    1.77359603   -0.02414961
*
```
计算步骤 3：将 opt-s0 的坐标粘贴过来，然后表头改为如下内容
```
! PBE0 def2-SVP TIGHTSCF ESD(ABS)  # 计算吸收光谱
%TDDFT 
NROOTS 5 
IROOT 1 
END 
%ESD 
GSHESSIAN "ph.hess"        # s0 的 hessian 矩阵文件
ESHESSIAN "ph_tdopt.hess"  3 s1 的 hessian 矩阵文件
DOHT TRUE 
END 
%pal nprocs 40
     end
%MaxCore 2560
* xyz 0 1
C   -1.21332282074681      0.56543988893455     -0.02322731761073
...
H   -3.00364745741339      1.77364106270239     -0.02455526514642
*
```

### 4. 安装 mdanalysis

用来分析动力学轨迹

参考网站 [安装步骤](https://www.mdanalysis.org/pages/installation_quick_start/https://www.mdanalysis.org/pages/installation_quick_start/)

需要有 Anaconda 环境
```
conda config --add channels conda-forge
conda install mdanalysis
```
